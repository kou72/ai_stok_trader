# Web Interface

株価予測モデル学習のWebインターフェースです。

## 概要

このWebアプリケーションは、`src/main.py`の学習処理をブラウザから実行できるインターフェースを提供します。

## 機能

- データセット（CSVディレクトリ）の選択
- ワンクリックで学習開始
- リアルタイムログ表示
- 学習の進捗状況表示
- 学習結果の保存先表示

## 必要なパッケージ

```bash
pip install flask
```

## 使い方

### 1. Webサーバーの起動

プロジェクトのルートディレクトリから以下のコマンドを実行します：

```bash
python web/app.py
```

または、webディレクトリ内で：

```bash
cd web
python app.py
```

### 2. ブラウザでアクセス

サーバーが起動したら、ブラウザで以下のURLにアクセスします：

```
http://localhost:5000
```

### 3. 学習の実行

1. ドロップダウンメニューから学習に使用するCSVディレクトリを選択
2. 「学習開始」ボタンをクリック
3. リアルタイムでログが表示されます
4. 学習が完了すると、結果保存先が表示されます

## ファイル構成

```
web/
├── app.py                 # Flaskアプリケーション本体
├── templates/
│   └── index.html        # HTMLテンプレート
├── static/
│   ├── style.css         # スタイルシート
│   └── script.js         # JavaScriptファイル
└── README.md             # このファイル
```

## API エンドポイント

### GET /
トップページを表示

### POST /start_training
学習を開始

**リクエストボディ:**
```json
{
  "csv_dir": "csv_20260126_003947"
}
```

**レスポンス:**
```json
{
  "message": "学習を開始しました",
  "status": "started"
}
```

### GET /status
学習の現在の状態を取得

**レスポンス:**
```json
{
  "is_running": true,
  "start_time": "2026-01-27 10:30:00",
  "end_time": null,
  "result_dir": null,
  "new_logs": ["ログメッセージ1", "ログメッセージ2"]
}
```

### GET /logs
全ログを取得

**レスポンス:**
```json
{
  "logs": ["ログメッセージ1", "ログメッセージ2", "..."]
}
```

## 注意事項

- 学習の実行中は別の学習を開始できません
- ブラウザを閉じても学習は継続されます
- 複数のブラウザタブで同時にアクセス可能です（学習状態は共有されます）
- サーバーを停止すると、実行中の学習も停止します

## トラブルシューティング

### ポート5000が既に使用されている

別のアプリケーションがポート5000を使用している場合、`app.py`の最後の行を変更してください：

```python
app.run(debug=True, host='0.0.0.0', port=8080)  # 5000を8080などに変更
```

### 学習が開始されない

- `data/csv_*` ディレクトリが存在するか確認してください
- `src/main.py` が正しく動作するか、コマンドラインから直接実行して確認してください

```bash
python src/main.py --csv data/csv_20260126_003947
```

### ログが表示されない

ブラウザの開発者ツール（F12）を開いて、コンソールにエラーが表示されていないか確認してください。

## 開発者向け

### デバッグモード

`app.py`の最後の行で`debug=True`が設定されているため、ファイルを変更すると自動的にサーバーが再起動します。

### カスタマイズ

- UI のカスタマイズ: [static/style.css](static/style.css)を編集
- 機能の追加: [app.py](app.py)にエンドポイントを追加
- フロントエンドのロジック: [static/script.js](static/script.js)を編集
